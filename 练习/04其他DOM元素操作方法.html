<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <style type="text/css">
        .hehe {
            background: red;
        }
    </style>
</head>
<body>
<button id="btn">单击添加span 放入div中最前面</button>
<div id="box">
    <p>pppp[pp]</p>

    <p>pppp[pp]</p>

    <p>pppp[pp]</p>

    <p>pppp[pp]</p>

    <p>pppp[pp]</p>

    <p>pppp[pp]</p>
    <em>em</em>
</div>
</body>
<script>
    function first(obj) {
        var ele = obj.firstElementChild || obj.firstChild;
        if (ele && ele.nodeType == 1) {
            return ele;
        } else {
            return null;
        }
    }

    function last(obj) {
        var ele = obj.lastElementChild || obj.lastChild;
        if (ele && ele.nodeType == 1) {
            return ele
        } else {
            return null;
        }
    }

    var oBox = document.getElementById("box");
    var oBtn = document.getElementById("btn");

    //    var oP=oBox.getElementsByTagName("p")[4];
    //    var span=document.createElement("span");
    //    span.innerHTML="span";
    //    span.className="hehe";
    //    oBox.insertBefore(span,oP);
    oBtn.onclick = function () {
        var span = document.createElement("span");
        span.innerHTML = "span";
        span.className = "hehe";
        oBox.insertBefore(span, first(oBox));
    }

    var oDiv=document.createElement("div");
    var oEm= last(oBox);
    oBox.replaceChild(oDiv,oEm);

</script>
</html>